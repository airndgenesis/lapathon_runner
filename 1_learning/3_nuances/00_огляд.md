# Особливості мови Мавка — Повний огляд

## Вступ

Парсер та інтерпретатор Мавки (версія 0.124.1+) мають низку особливостей, які **не є помилками програміста** — це технічні обмеження самого парсера та рантайму. Цей документ містить повний каталог усіх задокументованих особливостей з посиланнями на детальну документацію.

**Загальні симптоми:** 
- Помилки "Не вдалось розібрати на сполуки" (parse error)
- Помилки "Неможливо здійснити предмет" (runtime error)
- Помилки "Не вдалося перекодувати файл в код мавки" (encoding error)
- Неочікувані результати обчислень
- Повернення `недійсне` замість очікуваних значень

---

## Категорії особливостей

### 1️⃣ Критичні обмеження парсера (01-03)
Базові синтаксичні обмеження, що блокують компіляцію

### 2️⃣ Арифметика і точність (04-09)
Проблеми з математичними обчисленнями та порівняннями

### 3️⃣ Управління потоком виконання (10-12)
Особливості return-виразів та умовної логіки

### 4️⃣ Unicode та кодування (13-14)
Обмеження парсера щодо символів

### 5️⃣ Робота зі списками (15)
Особливості API списків

### 6️⃣ Іменування змінних (16)
Вимоги до назв змінних

### 7️⃣ Стандартна бібліотека (17)
⚠️ **КРИТИЧНО**: Стандартна бібліотека не працює

---

## 1️⃣ Критичні обмеження парсера

| # | Проблема | Симптом | Рішення | Документ |
|---|----------|---------|---------|----------|
| **01** | Оператор `та` не працює | Parse error | Використовуйте вкладені `якщо` | [→](./01_оператор_та.md) |
| **02** | `вернути` в циклах | Runtime error | Патерн акумулятора | [→](./02_повернення_в_циклах.md) |
| **03** | Неправильний синтаксис циклу | Parse error | `перебрати X як Y` (не `в` або `для`) | [→](./03_синтаксис_циклу.md) |

### Швидкий довідник

**01. Оператор "та" → Вкладені якщо**
```мавка
; ❌ Не працює
якщо а > 5 та б > 10
  вернути "так"
кінець

; ✅ Правильно
якщо а > 5
  якщо б > 10
    вернути "так"
  кінець
кінець
```

**02. Вернути в циклі → Патерн акумулятора**
```мавка
; ❌ Не працює
дія знайти(список)
  перебрати список як число
    якщо число > 100
      вернути число
    кінець
  кінець
кінець

; ✅ Правильно
дія знайти(список)
  знайдено = недійсне
  результат = -1
  перебрати список як число
    якщо знайдено == недійсне
      якщо число > 100
        знайдено = дійсне
        результат = число
      кінець
    кінець
  кінець
  вернути результат
кінець
```

**03. Синтаксис циклу → "як"**
```мавка
; ❌ Не працює
перебрати елемент в масив
  друк(елемент)
кінець

; ✅ Правильно
перебрати масив як елемент
  друк(елемент)
кінець
```

---

## 2️⃣ Арифметика і точність

| # | Проблема | Симптом | Рішення | Документ |
|---|----------|---------|---------|----------|
| **04** | Математика в порівняннях | Помилки на межах | Проміжні змінні | [→](./04_математика_в_порівняннях.md) |
| **05** | Арифметика в `вернути` | Неправильні результати | Проміжні змінні | [→](./05_арифметика_в_поверненні.md) |
| **06** | Нестабільність ділення | Повертає "нескінченність" | Guard clauses (перевірка != 0) | [→](./06_нестабільність_ділення.md) |
| **07** | Граничні значення float | Збої на межах | Тестуйте межа±1, явні перевірки | [→](./07_граничні_значення.md) |
| **08** | Ділення з округленням вгору | Float не можна використати | Модульний підхід | [→](./08_ділення_з_округленням.md) |
| **09** | Порівняння у вкладених `якщо` | Збої на межах | Проміжні булеві змінні | [→](./09_порівняння_у_вкладених_умовах.md) |

### Швидкий довідник

**04. Математика в порівняннях**
```мавка
; ⚠️ Ризиковано
якщо а * б < 100
  вернути "менше"
кінець

; ✅ Безпечно
результат = а * б
якщо результат < 100
  вернути "менше"
кінець
```

**05. Арифметика в return**
```мавка
; ⚠️ Ризиковано
вернути літрів_води - (кількість / 2)

; ✅ Безпечно
витрата = кількість / 2
залишок = літрів_води - витрата
вернути залишок
```

**06. Нестабільність ділення**
```мавка
; ❌ Небезпечно (повертає "нескінченність")
результат = а / б

; ✅ Безпечно
якщо б != 0
  результат = а / б
інакше
  результат = 0
кінець
```

**07. Граничні значення**
```мавка
; ⚠️ Ризиковано
якщо температура * 2 >= 100
  вернути "перегрів"
кінець

; ✅ Безпечно
подвійна = температура * 2
якщо подвійна >= 100
  вернути "перегрів"
кінець
```

**08. Ділення з округленням вгору (ceiling)**
```мавка
; ❌ Не працює (повертає float)
округлене = (чисельник / знаменник) + 1

; ✅ Правильно (модульний підхід)
остача = чисельник % знаменник
повних = чисельник - остача
повних = повних / знаменник
якщо остача > 0
  повних = повних + 1
кінець
```

**09. Порівняння у вкладених умовах**
```мавка
; ⚠️ Ризиковано на межах
якщо тижнів > 8
  якщо годин > 0
    вернути "результат"
  кінець
кінець

; ✅ Безпечно
перевірка_тижнів = тижнів > 8
перевірка_годин = годин > 0
якщо перевірка_тижнів
  якщо перевірка_годин
    вернути "результат"
  кінець
кінець
```

---

## 3️⃣ Управління потоком виконання

| # | Проблема | Симптом | Рішення | Документ |
|---|----------|---------|---------|----------|
| **10** | Неявні повернення | Повертає `недійсне` | Явне фінальне `вернути` | [→](./10_неявні_повернення.md) |
| **11** | Аномалія підрахунку в циклах | Runtime error | Логіка після циклу | [→](./11_аномалія_підрахунку.md) |
| **12** | Повернення без `інакше` | Повертає 1, 2, 3 замість значень | Явні блоки `інакше` | [→](./12_повернення_без_інакше.md) |

### Швидкий довідник

**10. Неявні повернення**
```мавка
; ❌ Небезпечно (може повернути недійсне)
дія класифікувати(оцінка)
  якщо оцінка >= 90
    вернути "відмінно"
  кінець
  якщо оцінка >= 70
    вернути "добре"
  кінець
кінець

; ✅ Безпечно
дія класифікувати(оцінка)
  якщо оцінка >= 90
    вернути "відмінно"
  кінець
  якщо оцінка >= 70
    вернути "добре"
  кінець
  вернути "незадовільно"  ; ← Обов'язкове catch-all повернення
кінець
```

**11. Аномалія підрахунку**
```мавка
; ❌ Не працює (runtime error)
дія чи_є_три(масив)
  лічильник = 0
  перебрати масив як елемент
    якщо елемент > 10
      лічильник = лічильник + 1
    кінець
    якщо лічильник == 3
      вернути дійсне
    кінець
  кінець
  вернути недійсне
кінець

; ✅ Правильно
дія чи_є_три(масив)
  лічильник = 0
  перебрати масив як елемент
    якщо елемент > 10
      лічильник = лічильник + 1
    кінець
  кінець
  якщо лічильник == 3
    вернути дійсне
  інакше
    вернути недійсне
  кінець
кінець
```

**12. Повернення без інакше**
```мавка
; ❌ Може повернути 1, 2, 3
дія перевірити(значення)
  якщо значення > 100
    вернути "багато"
  кінець
  вернути "мало"
кінець

; ✅ Завжди працює
дія перевірити(значення)
  якщо значення > 100
    вернути "багато"
  інакше
    вернути "мало"
  кінець
кінець
```

---

## 4️⃣ Unicode та кодування

| # | Проблема | Симптом | Рішення | Документ |
|---|----------|---------|---------|----------|
| **13** | Em dash (—) ламає парсер | Encoding error | Використовуйте `-` або `--` | [→](./13_тире_ламає_парсер.md) |
| **14** | Не-кириличні символи | Encoding error | Тільки українська кирилиця | [→](./14_не_кириличні_символи.md) |

### Швидкий довідник

**13. Em dash (—)**
```мавка
; ❌ Не працює (UTF-8 e2 80 94)
текст = "відкривай — обережно"

; ✅ Працює (ASCII 2d)
текст = "відкривай - обережно"
текст = "відкривай -- обережно"
```

**14. Не-кириличні символи**
```мавка
; ❌ Не працює (іврит, грецька, латинка)
текст = "значення: און"  ; іврит
текст = "alpha: α"       ; грецька
текст = "hello"          ; латинка

; ✅ Працює (українська кирилиця)
текст = "значення: він"
текст = "альфа: а"
текст = "привіт"
```

---

## 5️⃣ Робота зі списками

| # | Проблема | Симптом | Рішення | Документ |
|---|----------|---------|---------|----------|
| **15** | Розмір списку — властивість | Runtime error | Використовуйте `.розмір` (не метод) | [→](./15_розмір_списку.md) |

### Швидкий довідник

**15. Розмір списку**
```мавка
; ❌ Не працює
кількість = список.довжина()  ; помилка "Неможливо здійснити"
кількість = список.length()   ; не виконається
кількість = список.довжина    ; повертає недійсне

; ✅ Працює
кількість = список.розмір     ; властивість (без дужок)
```

---

## 6️⃣ Іменування змінних

| # | Проблема | Симптом | Рішення | Документ |
|---|----------|---------|---------|----------|
| **16** | Латинські символи заборонені | Encoding error | Використовуйте тільки кирилицю | [→](./16_латинські_символи_заборонені.md) |

### Швидкий довідник

**16. Латинські символи в змінних**
```мавка
; ❌ Не працює (Latin 't' = U+0074)
t_за_вікном = 5
n = 10
temperature = 20

; ✅ Працює (Cyrillic 'т' = U+0442)
т_за_вікном = 5
н = 10
температура = 20
```

**Візуально однакові, але різні:**
| Латинка | Кирилиця | Примітка |
|---------|----------|----------|
| a (U+0061) | а (U+0430) | Візуально ідентичні |
| o (U+006F) | о (U+043E) | Візуально ідентичні |
| e (U+0065) | е (U+0435) | Візуально ідентичні |
| t (U+0074) | т (U+0442) | Візуально схожі |
| n (U+006E) | н (U+043D) | Дуже схожі |

---

## 7️⃣ Стандартна бібліотека

| # | Проблема | Симптом | Рішення | Документ |
|---|----------|---------|---------|----------|
| **17** | Стандартна бібліотека не працює | Runtime error / недійсне | Реалізуйте функції вручну | [→](./17_стандартна_бібліотека_ненадійна.md) |

### Швидкий довідник

**17. Стандартна бібліотека ⚠️ КРИТИЧНО**
```мавка
; ❌ НЕ ПРАЦЮЄ (повертає недійсне або помилку)
взяти біб математика
округлене = математика.округлити(5.6)  ; помилка
стеля = математика.стеля(5.1)          ; помилка
ПІ = математика.ПІ                      ; недійсне

взяти біб читати
текст = читати("введіть: ")             ; помилка

взяти біб планувальник                  ; "Неможливо взяти модуль"
взяти біб інтернет                      ; "Не вдалося перекодувати"

; ✅ ПРАЦЮЄ - Реалізуйте вручну
; Округлення:
залишок = число % 1
якщо залишок >= 0.5
  округлене = число - залишок + 1
інакше
  округлене = число - залишок
кінець

; Стеля (див. документ 08):
остача = чисельник % знаменник
повних = (чисельник - остача) / знаменник
якщо остача > 0
  повних = повних + 1
кінець

; Константи:
ПІ = 3.14159265358979323846
Е = 2.71828182845904523536
```

**Критичний висновок:** Жодна функція стандартної бібліотеки НЕ працює надійно в Мавка 0.124.1. Уникайте `взяти біб` повністю.

---

## Діагностика помилок

### Помилка: "Не вдалось розібрати на сполуки"

**Можливі причини:**
1. Використовуєте оператор `та`? → [Документ 01](./01_оператор_та.md)
2. Неправильний синтаксис циклу (використовуєте `в` замість `як`)? → [Документ 03](./03_синтаксис_циклу.md)
3. Латинські символи в назвах змінних? → [Документ 16](./16_латинські_символи_заборонені.md)

### Помилка: "Неможливо здійснити предмет"

**Можливі причини:**
1. `вернути` всередині `перебрати`? → [Документ 02](./02_повернення_в_циклах.md)
2. Підрахунок з перевіркою всередині циклу? → [Документ 11](./11_аномалія_підрахунку.md)
3. Виклик `.довжина()` або `.length()` на списку? → [Документ 15](./15_розмір_списку.md)
4. Спроба використати функцію зі стандартної бібліотеки? → [Документ 17](./17_стандартна_бібліотека_ненадійна.md)

### Помилка: "Не вдалося перекодувати файл в код мавки"

**Можливі причини:**
1. Em dash (—) у рядках? → [Документ 13](./13_тире_ламає_парсер.md)
2. Не-кириличні Unicode символи? → [Документ 14](./14_не_кириличні_символи.md)
3. Латинські символи в назвах змінних? → [Документ 16](./16_латинські_символи_заборонені.md)

### Неочікувані результати (повертає `недійсне`, 1, 2, 3, або неправильні числа)

**Можливі причини:**
1. Неповні шляхи повернення? → [Документ 10](./10_неявні_повернення.md)
2. Повернення без явного блоку `інакше`? → [Документ 12](./12_повернення_без_інакше.md)
3. Арифметика безпосередньо в `вернути`? → [Документ 05](./05_арифметика_в_поверненні.md)
4. Математика в порівняннях? → [Документ 04](./04_математика_в_порівняннях.md)
5. Використання стандартної бібліотеки? → [Документ 17](./17_стандартна_бібліотека_ненадійна.md)

### Проблеми з обчисленнями

**Можливі причини:**
1. Ділення без перевірки на нуль? → [Документ 06](./06_нестабільність_ділення.md)
2. Граничні значення (межа-1, межа, межа+1)? → [Документ 07](./07_граничні_значення.md)
3. Спроба округлення вгору? → [Документ 08](./08_ділення_з_округленням.md)
4. Порівняння у вкладених умовах? → [Документ 09](./09_порівняння_у_вкладених_умовах.md)

### Проблеми зі стандартною бібліотекою

**Симптоми:**
- `взяти біб математика` завантажується, але функції повертають `недійсне`
- `взяти біб планувальник` → "Неможливо взяти модуль бібліотеки"
- `взяти біб інтернет` → "Не вдалося перекодувати файл в код мавки"
- Функції повертають `недійсне` замість значень

**Рішення:**
⚠️ **НЕ використовуйте стандартну бібліотеку взагалі** → [Документ 17](./17_стандартна_бібліотека_ненадійна.md)

Реалізуйте функції вручну:
- Округлення → використовуйте `число % 1` та умовну логіку
- Стеля (ceiling) → модульний підхід (документ 08)
- Константи (ПІ, Е) → визначте як звичайні змінні

---

## Комплексний приклад

Завдання: знайти перший елемент у діапазоні 10-100, підрахувати кількість таких елементів.

```мавка
; ❌ Порушує багато правил
дія аналізувати(масив)
  для елемент в масив                    ; ← Проблема 03
    якщо елемент > 10 та елемент < 100   ; ← Проблема 01
      вернути елемент                     ; ← Проблема 02
    кінець
  кінець
кінець

; ❌ Порушує інші правила
дія підрахувати_неправильно(масив)
  лічильник = 0
  перебрати масив як елемент
    якщо елемент * 2 > 50                ; ← Проблема 04
      лічильник = лічильник + 1
    кінець
    якщо лічильник == 3                  ; ← Проблема 11
      вернути "досить"
    кінець
  кінець
  вернути "мало"                         ; ← Проблема 12
кінець

; ✅ Правильна реалізація
дія аналізувати_правильно(масив)
  знайдено = недійсне
  результат = -1
  
  перебрати масив як елемент             ; ← Виправлення 03
    якщо знайдено == недійсне
      якщо елемент > 10                  ; ← Виправлення 01
        якщо елемент < 100               ; ← Виправлення 01
          знайдено = дійсне
          результат = елемент            ; ← Виправлення 02
        кінець
      кінець
    кінець
  кінець
  
  вернути результат
кінець

дія підрахувати_правильно(масив)
  лічильник = 0
  
  перебрати масив як елемент
    подвоєне = елемент * 2               ; ← Виправлення 04
    якщо подвоєне > 50
      лічильник = лічильник + 1
    кінець
  кінець
  
  ; ← Виправлення 11 (логіка після циклу)
  якщо лічильник == 3                    
    вернути "досить"
  інакше                                 ; ← Виправлення 12
    вернути "мало"
  кінець
кінець
```

---

## Золоті правила програмування на Мавці

### Синтаксис
1. ❌ Ніколи не використовуйте `та` — завжди вкладені `якщо`
2. ❌ Ніколи `вернути` всередині `перебрати` — використовуйте патерн акумулятора
3. ✅ Завжди `перебрати X як Y` (не `в` або `для`)

### Арифметика
4. ✅ Завжди обчислюйте в проміжні змінні перед порівняннями
5. ✅ Завжди обчислюйте в проміжні змінні перед `вернути`
6. ✅ Завжди перевіряйте знаменник != 0 перед діленням
7. ✅ Тестуйте граничні значення: межа-1, межа, межа+1
8. ✅ Для ceiling використовуйте модульний підхід

### Управління потоком
9. ✅ Завжди додавайте фінальне `вернути` або повний `інакше` блок
10. ✅ Логіку підрахунку виносьте після циклу, не всередину
11. ✅ Використовуйте явні блоки `інакше` замість послідовних return

### Unicode та іменування
12. ✅ Використовуйте `-` або `--` замість em dash `—`
13. ✅ Тільки українська кирилиця у рядках та змінних
14. ✅ `.розмір` для списків (властивість, не метод)
15. ✅ Тільки кириличні імена змінних (навіть для `т`, `н`, `а`)

### Стандартна бібліотека
16. ❌ **НІКОЛИ не використовуйте `взяти біб`** — стандартна бібліотека не працює
17. ✅ Реалізуйте всі функції вручну (округлення, математичні константи, тощо)

---

## Повний список документів

### Критичні обмеження парсера
- [01. Оператор "та" (AND)](./01_оператор_та.md) — вкладені `якщо`
- [02. Ранні повернення в циклах](./02_повернення_в_циклах.md) — патерн акумулятора
- [03. Синтаксис foreach-циклу](./03_синтаксис_циклу.md) — `перебрати X як Y`

### Арифметика і точність
- [04. Математика в порівняннях](./04_математика_в_порівняннях.md) — проміжні змінні
- [05. Арифметика в поверненні](./05_арифметика_в_поверненні.md) — проміжні змінні
- [06. Нестабільність ділення](./06_нестабільність_ділення.md) — guard clauses
- [07. Граничні значення](./07_граничні_значення.md) — тестування меж
- [08. Ділення з округленням](./08_ділення_з_округленням.md) — модульний підхід
- [09. Порівняння у вкладених умовах](./09_порівняння_у_вкладених_умовах.md) — булеві змінні

### Управління потоком
- [10. Неявні повернення](./10_неявні_повернення.md) — явні return paths
- [11. Аномалія підрахунку](./11_аномалія_підрахунку.md) — логіка після циклу
- [12. Повернення без інакше](./12_повернення_без_інакше.md) — явні `інакше` блоки

### Unicode та кодування
- [13. Тире ламає парсер](./13_тире_ламає_парсер.md) — використовуйте `-`
- [14. Не-кириличні символи](./14_не_кириличні_символи.md) — тільки кирилиця

### Списки та іменування
- [15. Розмір списку](./15_розмір_списку.md) — властивість `.розмір`
- [16. Латинські символи заборонені](./16_латинські_символи_заборонені.md) — тільки кирилиця

### Стандартна бібліотека
- [17. Стандартна бібліотека ненадійна](./17_стандартна_бібліотека_ненадійна.md) — ⚠️ **КРИТИЧНО**: не використовуйте `взяти біб`

---

## Додаткові ресурси

- **mavka_docs.md** — основна документація Мавки (синтаксис, типи, функції)
- **mavka_pecularities.md** — технічний список усіх особливостей (коротка довідка)
- **algorithms/** — 200 практичних прикладів алгоритмів на Мавці

---

*Документація створена на основі емпіричного тестування Мавки 0.124.1 та аналізу 200 алгоритмів • Оновлено: 1 січня 2026*
