# Стандартна бібліотека ненадійна (Standard Library Unreliable)

## Зміст

- [Симптоми](#симптоми)
- [Що обіцяє документація](#що-обіцяє-документація)
- [Реальність: що насправді працює](#реальність-що-насправді-працює)
- [Детальне тестування кожної бібліотеки](#детальне-тестування-кожної-бібліотеки)
- [Обхідні шляхи: як працювати без бібліотек](#обхідні-шляхи-як-працювати-без-бібліотек)
- [Приклади тестування](#приклади-тестування)
- [Верифікація](#верифікація)
- [Резюме](#резюме)

---

## Симптоми

Коли ви намагаєтеся використати стандартну бібліотеку Мавки (математика, читати, інтернет, планувальник), ви стикаєтеся з помилками:

```
Помилка в файлі.м:X
Неможливо здійснити недійсне (властивість "округлити").
```

або

```
Помилка в файлі.м:X
Неможливо взяти модуль бібліотеки.
```

або

```
Помилка в файлі.м
Не вдалося перекодувати файл в код мавки.
```

**Критична проблема:** Хоча документація описує стандартні бібліотеки, **вони не працюють** у версії 0.124.1.

---

## Що обіцяє документація

Згідно з офіційною документацією Мавки, ви маєте доступ до:

### 1. Бібліотека `математика`
```мавка
взяти біб математика

округлене = математика.округлити(5.6)
стеля = математика.стеля(5.1)
підлога = математика.підлога(5.9)
пі = математика.ПІ
синус = математика.синус(1.57)
косинус = математика.косинус(0)
```

### 2. Бібліотека `читати`
```мавка
взяти біб читати

введене = читати.рядок()
```

### 3. Бібліотека `планувальник`
```мавка
взяти біб планувальник

планувальник.затримка(1000)
```

### 4. Бібліотека `інтернет`
```мавка
взяти біб інтернет

відповідь = інтернет.запит("https://example.com")
```

---

## Реальність: що насправді працює

**Коротка відповідь: МАЙЖЕ НІЧОГО.**

| Бібліотека | Статус імпорту | Статус функцій | Практична користь |
|------------|----------------|----------------|-------------------|
| `математика` | ✅ Завантажується | ❌ Всі функції повертають `недійсне` | **НУЛЬ** |
| `читати` | ✅ Завантажується | ❌ Всі функції повертають `недійсне` | **НУЛЬ** |
| `планувальник` | ❌ Помилка завантаження | ❌ Недоступний | **НУЛЬ** |
| `інтернет` | ❌ Помилка парсера | ❌ Недоступний | **НУЛЬ** |

### Що таке "завантажується, але не працює"?

Коли ви робите `взяти біб математика`, парсер не видає помилку. Змінна `математика` існує і містить об'єкт `<модуль математика>`. Але **всі функції цього модуля недоступні** — вони повертають `недійсне` при спробі виклику.

---

## Детальне тестування кожної бібліотеки

### Тест 1: Бібліотека `математика` — округлити

**Код:**
```мавка
взяти біб математика

друк(математика.округлити(5.6))
```

**Очікуваний результат (згідно з документацією):**
```
6
```

**Реальний результат:**
```
Помилка в /tmp/тест.м:3
Неможливо здійснити недійсне (властивість "округлити").
```

❌ **НЕ ПРАЦЮЄ**

---

### Тест 2: Бібліотека `математика` — стеля та підлога

**Код:**
```мавка
взяти біб математика

друк(математика.стеля(5.1))
друк(математика.підлога(5.9))
```

**Очікуваний результат:**
```
6
5
```

**Реальний результат:**
```
Помилка в /tmp/тест.м:3
Неможливо здійснити недійсне (властивість "стеля").
```

❌ **НЕ ПРАЦЮЄ**

---

### Тест 3: Бібліотека `математика` — константа ПІ

**Код:**
```мавка
взяти біб математика

ПІ_ЗНАЧЕННЯ = математика.ПІ
друк(ПІ_ЗНАЧЕННЯ)
```

**Очікуваний результат:**
```
3.141592653589793
```

**Реальний результат:**
```
недійсне
```

❌ **НЕ ПРАЦЮЄ** — Константа `ПІ` не існує в модулі, повертається `недійсне`.

---

### Тест 4: Що взагалі міститься в модулі `математика`?

**Код:**
```мавка
взяти біб математика

друк("Що таке математика?")
друк(математика)
```

**Реальний результат:**
```
Що таке математика?
<модуль математика>
```

✅ **Модуль існує** — але це лише порожня оболонка без функціональності.

---

### Тест 5: Бібліотека `читати`

**Код:**
```мавка
взяти біб читати

друк("Введіть число:")
введене = читати.рядок()
друк("Ви ввели:")
друк(введене)
```

**Очікуваний результат:** Програма чекає введення, потім друкує його.

**Реальний результат:**
```
Введіть число:
Помилка в /tmp/тест.м:4
Неможливо здійснити недійсне (властивість "рядок").
```

❌ **НЕ ПРАЦЮЄ**

---

### Тест 6: Бібліотека `планувальник`

**Код:**
```мавка
взяти біб планувальник

друк("Тест планувальника")
планувальник.затримка(1000)
друк("Пройшла секунда")
```

**Очікуваний результат:** Програма друкує "Тест планувальника", чекає 1 секунду, друкує "Пройшла секунда".

**Реальний результат:**
```
Помилка в /tmp/тест.м:1
Неможливо взяти модуль бібліотеки.
```

❌ **НЕ ПРАЦЮЄ** — Модуль взагалі не завантажується.

---

### Тест 7: Бібліотека `інтернет`

**Код:**
```мавка
взяти біб інтернет

друк("Тест інтернет бібліотеки")
```

**Очікуваний результат:** Друкує "Тест інтернет бібліотеки".

**Реальний результат:**
```
Помилка в /tmp/тест.м
Не вдалося перекодувати файл в код мавки.
```

❌ **НЕ ПРАЦЮЄ** — Парсер ламається на етапі імпорту, ймовірно конфлікт з назвою або відсутністю модуля.

---

## Обхідні шляхи: як працювати без бібліотек

Оскільки стандартна бібліотека ненадійна, вам потрібно реалізувати всі функції **вручну**.

### 1. Замість `математика.підлога()` — Власна реалізація

**Підлога (floor)** — відкидання дробової частини:

```мавка
дія підлога(число)
  остача = число % 1
  результат = число - остача
  вернути результат
кінець

друк(підлога(5.9))  ; Виведе: 5
друк(підлога(7.2))  ; Виведе: 7
```

**Як це працює:**
- `число % 1` дає дробову частину (для `5.9` → `0.9`)
- Віднімаємо дробову частину від числа
- Отримуємо ціле число

---

### 2. Замість `математика.стеля()` — Округлення вгору

**Стеля (ceiling)** — округлення вгору до найближчого цілого:

```мавка
дія стеля(число)
  остача = число % 1
  базове = число - остача
  якщо остача > 0
    базове = базове + 1
  кінець
  вернути базове
кінець

друк(стеля(5.1))   ; Виведе: 6
друк(стеля(7.9))   ; Виведе: 8
друк(стеля(10.0))  ; Виведе: 10 (без зміни)
```

**Детальніше:** Дивіться [08. Ділення з округленням вгору](./08_ділення_з_округленням.md)

---

### 3. Замість `математика.округлити()` — Стандартне округлення

**Округлити (round)** — округлення до найближчого цілого (>= 0.5 вгору, < 0.5 вниз):

```мавка
дія округлити(число)
  остача = число % 1
  базове = число - остача
  якщо остача >= 0.5
    базове = базове + 1
  кінець
  вернути базове
кінець

друк(округлити(5.6))  ; Виведе: 6
друк(округлити(5.4))  ; Виведе: 5
друк(округлити(5.5))  ; Виведе: 6
```

**Примітка про точність:** У Мавці дробові числа мають проблеми з точністю (0.5999999999999996 замість 0.6), але порівняння `>= 0.5` працює коректно.

---

### 4. Замість `математика.ПІ` — Власна константа

**Константа ПІ:**

```мавка
ПІ = 3.14159265358979323846

дія обчислити_площу_кола(радіус)
  площа = ПІ * радіус * радіус
  вернути площа
кінець

друк(обчислити_площу_кола(5))   ; Виведе: 78.53981633974483
друк(обчислити_площу_кола(10))  ; Виведе: 314.1592653589793
```

✅ **Працює ідеально!**

---

### 5. Замість `читати.рядок()` — Немає альтернативи

❌ **Критичне обмеження:** У Мавці **немає способу** читати введення користувача з консолі.

**Наслідки:**
- Не можна створити інтерактивні програми
- Не можна запитувати дані від користувача
- Всі параметри мають бути жорстко закодовані або передані як аргументи функції

**Обхідний шлях:** Використовуйте аргументи функції замість введення:

```мавка
дія обчислити_результат(користувацьке_число)
  ; Замість читання з консолі, отримуємо параметром
  результат = користувацьке_число * 2
  вернути результат
кінець

; Викликаємо з різними значеннями
друк(обчислити_результат(10))
друк(обчислити_результат(25))
```

---

### 6. Замість `планувальник` та `інтернет` — Немає альтернативи

❌ **Повна відсутність:**
- Немає затримок
- Немає таймерів
- Немає HTTP-запитів
- Немає асинхронності

**Висновок:** Мавка підходить лише для **синхронних обчислювальних задач** без зовнішньої взаємодії.

---

## Приклади тестування

### Тест 1: Перевірка доступності функцій математики

Створіть файл `/tmp/тест_математика_доступність.м`:

```мавка
взяти біб математика

друк("Спроба 1: округлити")
друк(математика.округлити(5.6))
```

Запустіть:
```bash
~/мавка /tmp/тест_математика_доступність.м
```

**Очікуваний результат:**
```
Спроба 1: округлити
Помилка в /tmp/тест_математика_доступність.м:4
Неможливо здійснити недійсне (властивість "округлити").
```

---

### Тест 2: Перевірка константи ПІ

Створіть файл `/tmp/тест_пі.м`:

```мавка
взяти біб математика

друк(математика.ПІ)
```

Запустіть:
```bash
~/мавка /tmp/тест_пі.м
```

**Очікуваний результат:**
```
недійсне
```

---

### Тест 3: Власна реалізація працює

Створіть файл `/tmp/тест_власна_реалізація.м`:

```мавка
дія підлога(число)
  остача = число % 1
  результат = число - остача
  вернути результат
кінець

дія стеля(число)
  остача = число % 1
  базове = число - остача
  якщо остача > 0
    базове = базове + 1
  кінець
  вернути базове
кінець

дія округлити(число)
  остача = число % 1
  базове = число - остача
  якщо остача >= 0.5
    базове = базове + 1
  кінець
  вернути базове
кінець

ПІ = 3.14159265358979323846

друк("=== Тест підлога ===")
друк(підлога(5.9))
друк(підлога(7.2))

друк("")
друк("=== Тест стеля ===")
друк(стеля(5.1))
друк(стеля(7.9))

друк("")
друк("=== Тест округлити ===")
друк(округлити(5.6))
друк(округлити(5.4))
друк(округлити(5.5))

друк("")
друк("=== Тест ПІ ===")
друк(ПІ)
площа = ПІ * 5 * 5
друк("Площа кола (r=5):")
друк(площа)
```

Запустіть:
```bash
~/мавка /tmp/тест_власна_реалізація.м
```

**Очікуваний результат:**
```
=== Тест підлога ===
5
7

=== Тест стеля ===
6
8

=== Тест округлити ===
6
5
6

=== Тест ПІ ===
3.14159265358979323846
Площа кола (r=5):
78.53981633974483
```

✅ **Всі власні реалізації працюють!**

---

### Тест 4: Бібліотека читати не працює

Створіть файл `/tmp/тест_читати_провал.м`:

```мавка
взяти біб читати

друк(читати.рядок())
```

Запустіть:
```bash
echo "тестове введення" | ~/мавка /tmp/тест_читати_провал.м
```

**Очікуваний результат:**
```
Помилка в /tmp/тест_читати_провал.м:3
Неможливо здійснити недійсне (властивість "рядок").
```

---

### Тест 5: Планувальник та інтернет повністю недоступні

**Планувальник:**
```мавка
взяти біб планувальник
```

**Результат:**
```
Помилка в файлі.м:1
Неможливо взяти модуль бібліотеки.
```

**Інтернет:**
```мавка
взяти біб інтернет
```

**Результат:**
```
Помилка в файлі.м
Не вдалося перекодувати файл в код мавки.
```

---

## Верифікація

### Крок 1: Переконайтеся, що бібліотеки не працюють

Виконайте всі тести з розділу [Приклади тестування](#приклади-тестування).

### Крок 2: Створіть бібліотеку власних функцій

Рекомендується створити набір власних функцій для математики:

```мавка
; === БІБЛІОТЕКА МАТЕМАТИЧНИХ ФУНКЦІЙ ===

дія підлога(число)
  остача = число % 1
  вернути число - остача
кінець

дія стеля(число)
  остача = число % 1
  базове = число - остача
  якщо остача > 0
    базове = базове + 1
  кінець
  вернути базове
кінець

дія округлити(число)
  остача = число % 1
  базове = число - остача
  якщо остача >= 0.5
    базове = базове + 1
  кінець
  вернути базове
кінець

ПІ = 3.14159265358979323846
Е = 2.71828182845904523536

; === КІНЕЦЬ БІБЛІОТЕКИ ===

; Ваш код тут:
друк(підлога(5.9))
друк(стеля(5.1))
друк(округлити(5.5))
друк(ПІ)
```

### Крок 3: Перевірте версію Мавки

```bash
~/мавка --version
```

**Версія на момент тестування:** 0.124.1

**Важливо:** У майбутніх версіях ситуація може змінитися. Але станом на 1 січня 2026 року стандартна бібліотека **НЕ працює**.

---

## Резюме

### Що НЕ працює

- ❌ **`математика.округлити()`** — повертає `недійсне`
- ❌ **`математика.стеля()`** — повертає `недійсне`
- ❌ **`математика.підлога()`** — повертає `недійсне`
- ❌ **`математика.ПІ`** — повертає `недійсне`
- ❌ **`математика.синус()`** — не перевірено, але з великою ймовірністю не працює
- ❌ **`математика.косинус()`** — не перевірено, але з великою ймовірністю не працює
- ❌ **`читати.рядок()`** — повертає `недійсне`
- ❌ **`планувальник`** — модуль не завантажується
- ❌ **`інтернет`** — викликає помилку парсера

### Що працює

- ✅ **Власна реалізація `підлога()`** через `число % 1`
- ✅ **Власна реалізація `стеля()`** через модуло та умову
- ✅ **Власна реалізація `округлити()`** через модуло та порівняння >= 0.5
- ✅ **Власна константа `ПІ`** — просто визначте змінну
- ✅ **Базові математичні оператори:** `+`, `-`, `*`, `/`, `%`, `**`

### Золоте правило

**НІКОЛИ НЕ ПОКЛАДАЙТЕСЯ НА `взяти біб` У ВЕРСІЇ 0.124.1**

Завжди:
1. Реалізовуйте математичні функції вручну
2. Визначайте константи (ПІ, Е) як звичайні змінні
3. Не розраховуйте на введення/виведення крім `друк()`
4. Не очікуйте асинхронність або мережеві можливості

### Рекомендована стратегія

Створіть **власну бібліотеку** на початку кожного файла:

```мавка
; === МОЯ МАТЕМАТИЧНА БІБЛІОТЕКА ===

ПІ = 3.14159265358979323846

дія підлога(ч)
  вернути ч - (ч % 1)
кінець

дія стеля(ч)
  о = ч % 1
  б = ч - о
  якщо о > 0
    б = б + 1
  кінець
  вернути б
кінець

дія округлити(ч)
  о = ч % 1
  б = ч - о
  якщо о >= 0.5
    б = б + 1
  кінець
  вернути б
кінець

; === КІНЕЦЬ БІБЛІОТЕКИ ===

; Основний код нижче
```

Це **єдиний надійний спосіб** працювати з математичними функціями у Мавці.

---

**Повернутися до:** [Огляд критичних обмежень](./00_огляд.md)

**Попереднє обмеження:** [16. Латинські символи заборонені](./16_латинські_символи_заборонені.md)

---

*Документ створено на основі всебічного емпіричного тестування парсера Мавки версії 0.124.1*  
*Критична проблема: стандартна бібліотека документована, але повністю нефункціональна*  
*Виявлено при спробах використання математичних функцій у алгоритмах 001-200*  
*Останнє оновлення: 1 січня 2026*
