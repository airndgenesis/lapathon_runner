# Синтаксис foreach-циклу

## Зміст

- [Симптоми](#симптоми)
- [Код, що НЕ працює](#код-що-не-працює)
- [Чому це відбувається](#чому-це-відбувається)
- [Правильний синтаксис](#правильний-синтаксис)
- [Приклади тестування](#приклади-тестування)
- [Верифікація](#верифікація)
- [Мнемонічна допомога](#мнемонічна-допомога)

---

## Симптоми

Якщо ви використовуєте Python-подібний синтаксис з ключовими словами `в` (in) або `для` (for), парсер видає помилку:

```
Помилка в файлі.м:X
Не вдалось розібрати на сполуки.
```

---

## Код, що НЕ працює

### Варіант 1: Синтаксис з "в"

```мавка
дія сума_масиву(масив)
  сума = 0
  перебрати елемент в масив
    сума = сума + елемент
  кінець
  вернути сума
кінець
```

### Варіант 2: Синтаксис з "для"

```мавка
дія сума_масиву(масив)
  сума = 0
  для елемент в масив
    сума = сума + елемент
  кінець
  вернути сума
кінець
```

Обидва варіанти викличуть помилку парсера на рядку з циклом.

---

## Чому це відбувається

**Мавка — це не Python!** Мова має власний український синтаксис, який не копіює інші мови.

### Порівняння з іншими мовами

**Python:**
```python
for element in array:
    print(element)
```

**JavaScript:**
```javascript
for (let element of array) {
    console.log(element);
}
```

**Мавка (унікальний синтаксис):**
```мавка
перебрати array як element
  друк(element)
кінець
```

### Технічна причина

Мавка використовує **унікальне українське ключове слово `як`** (as):

```мавка
перебрати масив як елемент
```

**Українською це читається як:** "перебрати масив як елемент" — тобто "обійти масив, трактуючи кожну одиницю як елемент".

**Технічна деталь:** Ключове слово `як` є частиною формального синтаксису мови Мавка і закладено в граматику парсера. Використання `в` або `для` порушує цю граматику.

---

## Правильний синтаксис

### Загальна форма

```мавка
перебрати <колекція> як <ітератор>
  ; тіло циклу
кінець
```

**Компоненти:**
- `<колекція>` — змінна, що містить масив/список
- `<ітератор>` — ім'я змінної для поточного елементу
- `як` — ключове слово (обов'язкове!)

### Базовий приклад

```мавка
числа = [10, 20, 30]
перебрати числа як число
  друк(число)
кінець
```

**Вивід:**
```
10
20
30
```

---

## Приклади тестування

### Тест 1: Базова ітерація

**Неправильно:**
```мавка
міста = ["Київ", "Львів", "Одеса"]
перебрати місто в міста
  друк(місто)
кінець
```

**Правильно:**
```мавка
міста = ["Київ", "Львів", "Одеса"]
перебрати міста як місто
  друк(місто)
кінець
```

**Вивід:**
```
Київ
Львів
Одеса
```

---

### Тест 2: Сума чисел

**Неправильно:**
```мавка
числа = [10, 20, 30, 40]
сума = 0
для число в числа
  сума = сума + число
кінець
друк(сума)
```

**Правильно:**
```мавка
числа = [10, 20, 30, 40]
сума = 0
перебрати числа як число
  сума = сума + число
кінець
друк(сума)
```

**Вивід:**
```
100
```

---

### Тест 3: Ітерація з індексацією

**Правильно:**
```мавка
продукти = ["хліб", "молоко", "яйця"]
індекс = 0
перебрати продукти як продукт
  друк("%(індекс): %(продукт)")
  індекс = індекс + 1
кінець
```

**Вивід:**
```
0: хліб
1: молоко
2: яйця
```

---

### Тест 4: Вкладені цикли

**Правильно:**
```мавка
рядки = [[1, 2], [3, 4], [5, 6]]
перебрати рядки як рядок
  перебрати рядок як елемент
    друк(елемент)
  кінець
кінець
```

**Вивід:**
```
1
2
3
4
5
6
```

---

### Тест 5: Фільтрація елементів

**Правильно:**
```мавка
дія відібрати_парні(масив)
  результат = []
  перебрати масив як елемент
    якщо елемент % 2 == 0
      результат.додати(елемент)
    кінець
  кінець
  вернути результат
кінець

числа = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
парні = відібрати_парні(числа)
друк(парні)
```

**Вивід:**
```
[2, 4, 6, 8, 10]
```

---

### Тест 6: Підрахунок елементів

**Правильно:**
```мавка
дія порахувати_більші_за(масив, поріг)
  лічильник = 0
  перебрати масив як елемент
    якщо елемент > поріг
      лічильник = лічильник + 1
    кінець
  кінець
  вернути лічильник
кінець

числа = [10, 50, 30, 80, 20, 100]
друк(порахувати_більші_за(числа, 40))
```

**Вивід:**
```
3
```

---

### Тест 7: Масиви рядків з умовами

**Правильно:**
```мавка
дія знайти_короткі_слова(слова, максимальна_довжина)
  результат = []
  перебрати слова як слово
    якщо слово.довжина <= максимальна_довжина
      результат.додати(слово)
    кінець
  кінець
  вернути результат
кінець

слова = ["кіт", "собака", "миша", "папуга", "риба"]
короткі = знайти_короткі_слова(слова, 4)
перебрати короткі як слово
  друк(слово)
кінець
```

**Вивід:**
```
кіт
миша
риба
```

---

## Верифікація

### Крок 1: Тест неправильного синтаксису з "в"

Створіть тестовий файл `/tmp/тест_синтаксис.м`:

```мавка
дія тест_неправильно()
  масив = [100, 200, 300]
  перебрати елемент в масив
    друк(елемент)
  кінець
кінець

тест_неправильно()
```

Запустіть:
```bash
~/мавка /tmp/тест_синтаксис.м
```

**Очікуваний результат:** Помилка парсера "Не вдалось розібрати на сполуки."

---

### Крок 2: Тест неправильного синтаксису з "для"

Змініть файл `/tmp/тест_синтаксис.м`:

```мавка
дія тест_неправильно()
  масив = [100, 200, 300]
  для елемент в масив
    друк(елемент)
  кінець
кінець

тест_неправильно()
```

Запустіть:
```bash
~/мавка /tmp/тест_синтаксис.м
```

**Очікуваний результат:** Помилка парсера "Не вдалось розібрати на сполуки."

---

### Крок 3: Тест правильного синтаксису

Тепер виправте на правильний синтаксис:

```мавка
дія тест_правильно()
  масив = [100, 200, 300]
  сума = 0
  перебрати масив як елемент
    друк(елемент)
    сума = сума + елемент
  кінець
  друк("Сума: %(сума)")
кінець

тест_правильно()
```

Запустіть:
```bash
~/мавка /tmp/тест_синтаксис.м
```

**Очікуваний результат:**
```
100
200
300
Сума: 600
```

---

### Крок 4: Комплексний тест

```мавка
дія демонстрація_синтаксису()
  масив_міст = ["Київ", "Львів", "Одеса", "Харків"]
  
  друк("=== Правильний синтаксис (як) ===")
  перебрати масив_міст як місто
    друк(місто)
  кінець
  
  друк("")
  друк("=== Працює з числами ===")
  числа = [100, 200, 300]
  сума = 0
  перебрати числа як число
    сума = сума + число
  кінець
  друк(сума)
  
  друк("")
  друк("=== Працює з індексацією ===")
  індекс = 0
  перебрати масив_міст як місто
    друк("%(індекс): %(місто)")
    індекс = індекс + 1
  кінець
кінець

демонстрація_синтаксису()
```

**Очікуваний результат:**
```
=== Правильний синтаксис (як) ===
Київ
Львів
Одеса
Харків

=== Працює з числами ===
600

=== Працює з індексацією ===
0: Київ
1: Львів
2: Одеса
3: Харків
```

---

## Мнемонічна допомога

Щоб запам'ятати синтаксис, уявіть собі таке речення:

**"Перебрати список як книги — взяти кожну книгу окремо"**

```мавка
перебрати список_книг як книга
  друк(книга)
кінець
```

Слово **`як`** вказує на роль, яку відіграє кожен елемент в ітерації.

### Інші асоціації

- **"Перебрати студентів як особа"** → кожен студент розглядається як окрема особа
- **"Перебрати числа як значення"** → кожне число розглядається як окреме значення
- **"Перебрати дні як день"** → кожен день розглядається окремо

---

## Порівняння з іншими мовами

| Мова | Синтаксис | Ключове слово |
|------|-----------|---------------|
| **Python** | `for element in array:` | `in` |
| **JavaScript** | `for (let element of array)` | `of` |
| **Ruby** | `array.each do \|element\|` | `do \|...\|` |
| **Swift** | `for element in array` | `in` |
| **Мавка** | `перебрати array як element` | **`як`** |

**Висновок:** Мавка має унікальний український синтаксис, який не копіює інші мови.

---

## Резюме

### Що не працює
- `перебрати елемент в масив` — помилка парсера
- `для елемент в масив` — помилка парсера
- `перебрати елемент з масив` — помилка парсера
- Будь-які інші варіації крім `як`

### Що працює
- `перебрати масив як елемент` — єдиний правильний синтаксис
- Працює з масивами чисел, рядків, об'єктів
- Працює у вкладених циклах
- Працює всередині функцій

### Золоте правило
**Завжди використовуйте синтаксис `перебрати <колекція> як <ітератор>`** — це єдиний валідний спосіб ітерації в Мавці.

---

**Повернутися до:** [Огляд критичних обмежень](./00_огляд.md)

**Попереднє обмеження:** [02. Ранні повернення в циклах](./02_повернення_в_циклах.md)

---

*Документ створено на основі емпіричного тестування парсера Мавки версії 0.124.1*  
*Останнє оновлення: 1 січня 2026*
