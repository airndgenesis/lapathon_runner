# Ділення з округленням вгору (Integer Ceiling Division)

## Зміст

- [Симптоми](#симптоми)
- [Проблема: дробові числа в Мавці](#проблема-дробові-числа-в-мавці)
- [Код, що НЕ працює](#код-що-не-працює)
- [Чому це відбувається](#чому-це-відбувається)
- [Рішення: модульний підхід](#рішення-модульний-підхід)
- [Приклади тестування](#приклади-тестування)
- [Верифікація](#верифікація)
- [Резюме](#резюме)

---

## Симптоми

Коли вам потрібно розділити число з округленням вгору (аналог `Math.ceil()` в JavaScript), виникають труднощі:

- Звичайне ділення `/` повертає дробове число (float)
- Немає вбудованої функції для округлення вгору
- Неможливо надійно перетворити float на ціле число
- Дробові результати не можна використати як індекси масиву
- Неможливо працювати з float для отримання цілого значення

**Приклад проблеми:**
```мавка
результат = 7 / 3  ; Повертає 2.333333333333333
; Як отримати 3 (округлено вгору)?
```

---

## Проблема: дробові числа в Мавці

### Що повертає звичайне ділення

```мавка
дія тест_ділення()
  результат = 7 / 3
  друк(результат)  ; Виведе: 2.333333333333333
  
  додано = результат + 1
  друк(додано)  ; Виведе: 3.333333333333333
  
  ; Але це все ще float, не ціле число!
  вернути результат
кінець
```

**Проблема:** У Мавці немає способу:
1. Округлити float вгору до цілого
2. Перетворити float на int
3. Отримати тільки цілу частину числа

---

## Код, що НЕ працює

### Спроба 1: Використання звичайного ділення

```мавка
дія поділити_банки(загальна_кількість, розмір_банки)
  ; Скільки банок потрібно, щоб вмістити все?
  результат = загальна_кількість / розмір_банки
  вернути результат  ; Проблема: повертає float (2.5), а не 3
кінець

друк(поділити_банки(25, 10))  ; Виведе: 2.5, а треба 3
```

### Спроба 2: Додавання одиниці

```мавка
дія поділити_з_додаванням(загальна_кількість, розмір_банки)
  результат = загальна_кількість / розмір_банки
  результат = результат + 1  ; Все одно float!
  вернути результат
кінець

друк(поділити_з_додаванням(25, 10))  ; Виведе: 3.5, неправильно!
```

### Спроба 3: Використання як індекс масиву

```мавка
дія взяти_елемент(масив, чисельник, знаменник)
  індекс = чисельник / знаменник
  вернути масив[індекс]  ; Помилка! Float не може бути індексом
кінець
```

---

## Чому це відбувається

**Технічні причини:**

1. **Оператор `/` завжди повертає float** — навіть для цілих чисел:
   - `6 / 3` → `2.0` (float)
   - `7 / 3` → `2.333333...` (float)

2. **Немає вбудованих функцій округлення:**
   - Немає `Math.ceil()` як у JavaScript
   - Немає `округлити_вгору()`
   - Немає способу перетворити `2.5` → `3`

3. **Float не можна використати для індексації:**
   - `масив[2.5]` — помилка
   - Потрібне ціле число

4. **Неможливість конвертації типів:**
   - Немає функції `int()` або `ціле()`
   - Неможливо відкинути дробову частину

---

## Рішення: модульний підхід

**Золоте правило:** Працюйте виключно з цілими числами через оператор модуло `%`.

### Алгоритм

```мавка
; Крок 1: Отримати остачу від ділення
остача = чисельник % знаменник

; Крок 2: Відняти остачу, щоб отримати кратне число
повних_частин = чисельник - остача

; Крок 3: Поділити (тепер результат буде цілим)
повних_частин = повних_частин / знаменник

; Крок 4: Додати 1, якщо була остача
якщо остача > 0
  повних_частин = повних_частин + 1
кінець

; повних_частин тепер містить ceiling(чисельник / знаменник)
```

### Повна функція

```мавка
дія округлити_вгору(чисельник, знаменник)
  остача = чисельник % знаменник
  повних_частин = чисельник - остача
  повних_частин = повних_частин / знаменник
  якщо остача > 0
    повних_частин = повних_частин + 1
  кінець
  вернути повних_частин
кінець
```

### Чому це працює

**Приклад:** `округлити_вгору(7, 3)`

```мавка
остача = 7 % 3           ; остача = 1
повних_частин = 7 - 1    ; повних_частин = 6
повних_частин = 6 / 3    ; повних_частин = 2 (ціле!)
остача > 0               ; дійсне, додаємо 1
повних_частин = 2 + 1    ; повних_частин = 3
```

**Результат:** `3` — правильне округлення вгору для `7 / 3 = 2.33...`

---

## Приклади тестування

### Тест 1: Базове округлення вгору

```мавка
дія округлити_вгору(чисельник, знаменник)
  остача = чисельник % знаменник
  повних_частин = чисельник - остача
  повних_частин = повних_частин / знаменник
  якщо остача > 0
    повних_частин = повних_частин + 1
  кінець
  вернути повних_частин
кінець

друк(округлити_вгору(7, 3))   ; Виведе: 3
друк(округлити_вгору(10, 3))  ; Виведе: 4
друк(округлити_вгору(9, 3))   ; Виведе: 3 (без округлення)
```

**Очікуваний результат:**
```
3
4
3
```

---

### Тест 2: Малі числа

```мавка
дія округлити_вгору(чисельник, знаменник)
  остача = чисельник % знаменник
  повних_частин = чисельник - остача
  повних_частин = повних_частин / знаменник
  якщо остача > 0
    повних_частин = повних_частин + 1
  кінець
  вернути повних_частин
кінець

друк(округлити_вгору(1, 5))  ; Виведе: 1 (0.2 → 1)
друк(округлити_вгору(4, 5))  ; Виведе: 1 (0.8 → 1)
друк(округлити_вгору(5, 5))  ; Виведе: 1 (точно)
друк(округлити_вгору(6, 5))  ; Виведе: 2 (1.2 → 2)
```

**Очікуваний результат:**
```
1
1
1
2
```

---

### Тест 3: Великі числа

```мавка
дія округлити_вгору(чисельник, знаменник)
  остача = чисельник % знаменник
  повних_частин = чисельник - остача
  повних_частин = повних_частин / знаменник
  якщо остача > 0
    повних_частин = повних_частин + 1
  кінець
  вернути повних_частин
кінець

друк(округлити_вгору(100, 7))   ; Виведе: 15 (14.28... → 15)
друк(округлити_вгору(1000, 33)) ; Виведе: 31 (30.30... → 31)
друк(округлити_вгору(500, 25))  ; Виведе: 20 (точно)
```

**Очікуваний результат:**
```
15
31
20
```

---

### Тест 4: Практичний приклад — банки для консервації

```мавка
дія скільки_банок_потрібно(кількість_огірків, огірків_в_банку)
  остача = кількість_огірків % огірків_в_банку
  повних_банок = кількість_огірків - остача
  повних_банок = повних_банок / огірків_в_банку
  якщо остача > 0
    повних_банок = повних_банок + 1
  кінець
  вернути повних_банок
кінець

друк("У мене 47 огірків, в банку вміщується 8 огірків")
друк("Потрібно банок:")
друк(скільки_банок_потрібно(47, 8))  ; Виведе: 6

друк("")
друк("У мене 80 огірків, в банку вміщується 10 огірків")
друк("Потрібно банок:")
друк(скільки_банок_потрібно(80, 10))  ; Виведе: 8
```

**Очікуваний результат:**
```
У мене 47 огірків, в банку вміщується 8 огірків
Потрібно банок:
6

У мене 80 огірків, в банку вміщується 10 огірків
Потрібно банок:
8
```

---

### Тест 5: Сторінки в книзі

```мавka
дія скільки_сторінок(кількість_рядків, рядків_на_сторінку)
  остача = кількість_рядків % рядків_на_сторінку
  повних_сторінок = кількість_рядків - остача
  повних_сторінок = повних_сторінок / рядків_на_сторінку
  якщо остача > 0
    повних_сторінок = повних_сторінок + 1
  кінець
  вернути повних_сторінок
кінець

друк(скільки_сторінок(100, 30))  ; Виведе: 4 (3.33... → 4)
друк(скільки_сторінок(90, 30))   ; Виведе: 3 (точно)
друк(скільки_сторінок(91, 30))   ; Виведе: 4 (3.03... → 4)
```

**Очікуваний результат:**
```
4
3
4
```

---

### Тест 6: Автобуси для екскурсії

```мавка
дія скільки_автобусів(кількість_людей, місць_в_автобусі)
  остача = кількість_людей % місць_в_автобусі
  повних_автобусів = кількість_людей - остача
  повних_автобусів = повних_автобусів / місць_в_автобусі
  якщо остача > 0
    повних_автобусів = повних_автобусів + 1
  кінець
  вернути повних_автобусів
кінець

друк("45 людей, 50 місць в автобусі:")
друк(скільки_автобусів(45, 50))  ; Виведе: 1

друк("55 людей, 50 місць в автобусі:")
друк(скільки_автобусів(55, 50))  ; Виведе: 2

друк("150 людей, 50 місць в автобусі:")
друк(скільки_автобусів(150, 50))  ; Виведе: 3
```

**Очікуваний результат:**
```
45 людей, 50 місць в автобусі:
1
55 людей, 50 місць в автобусі:
2
150 людей, 50 місць в автобусі:
3
```

---

### Тест 7: Крайні випадки

```мавка
дія округлити_вгору(чисельник, знаменник)
  остача = чисельник % знаменник
  повних_частин = чисельник - остача
  повних_частин = повних_частин / знаменник
  якщо остача > 0
    повних_частин = повних_частин + 1
  кінець
  вернути повних_частин
кінець

; Ділення на 1
друк(округлити_вгору(7, 1))   ; Виведе: 7

; Ділення на себе
друк(округлити_вгору(5, 5))   ; Виведе: 1

; Ділення меншого на більше
друк(округлити_вгору(3, 10))  ; Виведе: 1

; Ділення нуля
друк(округлити_вгору(0, 5))   ; Виведе: 0
```

**Очікуваний результат:**
```
7
1
1
0
```

---

## Верифікація

### Крок 1: Створіть тестовий файл

Створіть файл `/tmp/тест_округлення_вгору.м`:

```мавка
дія округлити_вгору(чисельник, знаменник)
  остача = чисельник % знаменник
  повних_частин = чисельник - остача
  повних_частин = повних_частин / знаменник
  якщо остача > 0
    повних_частин = повних_частин + 1
  кінець
  вернути повних_частин
кінець

друк("=== Тест 1: 7 / 3 = 3 ===")
друк(округлити_вгору(7, 3))

друк("=== Тест 2: 10 / 3 = 4 ===")
друк(округлити_вгору(10, 3))

друк("=== Тест 3: 9 / 3 = 3 ===")
друк(округлити_вгору(9, 3))

друк("=== Тест 4: 1 / 5 = 1 ===")
друк(округлити_вгору(1, 5))

друк("=== Тест 5: 15 / 4 = 4 ===")
друк(округлити_вгору(15, 4))

друк("=== Тест 6: 20 / 5 = 4 ===")
друк(округлити_вгору(20, 5))

друк("=== Тест 7: 100 / 7 = 15 ===")
друк(округлити_вгору(100, 7))
```

### Крок 2: Запустіть тест

```bash
~/мавка /tmp/тест_округлення_вгору.м
```

**Очікуваний результат:**
```
=== Тест 1: 7 / 3 = 3 ===
3
=== Тест 2: 10 / 3 = 4 ===
4
=== Тест 3: 9 / 3 = 3 ===
3
=== Тест 4: 1 / 5 = 1 ===
1
=== Тест 5: 15 / 4 = 4 ===
4
=== Тест 6: 20 / 5 = 4 ===
4
=== Тест 7: 100 / 7 = 15 ===
15
```

✅ **Всі тести пройшли успішно!**

---

### Крок 3: Порівняння з JavaScript Math.ceil()

Для розуміння, як ця реалізація відповідає стандартній функції `Math.ceil()`:

**JavaScript:**
```javascript
Math.ceil(7 / 3)   // 3
Math.ceil(10 / 3)  // 4
Math.ceil(9 / 3)   // 3
Math.ceil(1 / 5)   // 1
Math.ceil(100 / 7) // 15
```

**Мавка (наше рішення):**
```мавка
округлити_вгору(7, 3)   ; 3
округлити_вгору(10, 3)  ; 4
округлити_вгору(9, 3)   ; 3
округлити_вгору(1, 5)   ; 1
округлити_вгору(100, 7) ; 15
```

✅ **Результати ідентичні!**

---

## Резюме

### Що не працює

- ❌ Звичайне ділення `/` для отримання цілого результату з округленням
- ❌ Немає вбудованої функції `Math.ceil()` або `округлити_вгору()`
- ❌ Неможливо конвертувати float в int
- ❌ Float не можна використати як індекс масиву
- ❌ Додавання одиниці до float не дає цілого числа

### Що працює

- ✅ **Модульний підхід** через оператор `%`
- ✅ Робота виключно з цілими числами
- ✅ Покроковий алгоритм: остача → базове ділення → +1 якщо остача > 0
- ✅ Результат завжди ціле число
- ✅ Працює для будь-яких розмірів чисел

### Золоте правило

**Для округлення вгору завжди використовуйте модульний підхід:**

```мавка
остача = чисельник % знаменник
повних_частин = чисельник - остача
повних_частин = повних_частин / знаменник
якщо остача > 0
  повних_частин = повних_частин + 1
кінець
```

Це єдиний надійний спосіб реалізувати `Math.ceil()` у Мавці.

---

**Повернутися до:** [Огляд критичних обмежень](./00_огляд.md)

**Наступне обмеження:** [09. Інші особливості](./09_інші_особливості.md)

---

*Документ створено на основі емпіричного тестування парсера Мавки версії 0.124.1*  
*Виявлено в алгоритмі 131 (Зимові Запаси: Розрахунок Консервації)*  
*Останнє оновлення: 1 січня 2026*
